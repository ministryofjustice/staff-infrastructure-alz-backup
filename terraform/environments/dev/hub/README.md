<!-- BEGIN_TF_DOCS -->

## Requirements

| Name                                                                     | Version |
| ------------------------------------------------------------------------ | ------- |
| <a name="requirement_terraform"></a> [terraform](#requirement_terraform) | =1.5.7  |
| <a name="requirement_azurerm"></a> [azurerm](#requirement_azurerm)       | 3.84.0  |

## Providers

| Name                                                                           | Version |
| ------------------------------------------------------------------------------ | ------- |
| <a name="provider_azurerm"></a> [azurerm](#provider_azurerm)                   | 3.64.0  |
| <a name="provider_azurerm.spoke"></a> [azurerm.spoke](#provider_azurerm.spoke) | 3.64.0  |
| <a name="provider_terraform"></a> [terraform](#provider_terraform)             | n/a     |

## Modules

No modules.

## Resources

| Name                                                                                                                                                   | Type        |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------- |
| [azurerm_backup_policy_vm.policy](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/resources/backup_policy_vm)                    | resource    |
| [azurerm_backup_protected_vm.vm](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/resources/backup_protected_vm)                  | resource    |
| [azurerm_client_config.current](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/data-sources/client_config)                      | data source |
| [azurerm_recovery_services_vault.existing](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/data-sources/recovery_services_vault) | data source |
| [azurerm_resource_group.vault](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/data-sources/resource_group)                      | data source |
| [azurerm_virtual_machine.vm](https://registry.terraform.io/providers/hashicorp/azurerm/3.84.0/docs/data-sources/virtual_machine)                       | data source |
| [terraform_remote_state.alz_core_hub](https://registry.terraform.io/providers/hashicorp/terraform/latest/docs/data-sources/remote_state)               | data source |

## Inputs

| Name                                                                                                            | Description                                                                                       | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Default | Required |
| --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- | :------: |
| <a name="input_action_groups"></a> [action_groups](#input_action_groups)                                        | Action group definitions.                                                                         | <pre>map(object({<br> resource_group = string<br> location = string<br> action_group_name = string<br> email_config = list(map(string))<br> logic_app_config = list(map(string))<br> }))</pre>                                                                                                                                                                                                                                                                                                                                               | `null`  |    no    |
| <a name="input_backup_policies"></a> [backup_policies](#input_backup_policies)                                  | The backup policies.                                                                              | <pre>list(object({<br> name = string<br> policy_type = string<br> backup = object({<br> frequency = string<br> time = string<br> hour_interval = optional(string)<br> hour_duration = optional(string)<br> })<br> retention_daily = optional(object({<br> count = number<br> }))<br> retention_weekly = optional(object({<br> weekdays = list(string)<br> count = number<br> }))<br> retention_monthly = optional(object({<br> count = number<br> weekdays = optional(list(string))<br> weeks = optional(list(string))<br> }))<br> }))</pre> | n/a     |   yes    |
| <a name="input_custom_query_rules"></a> [custom_query_rules](#input_custom_query_rules)                         | Configuration for Backup Alerts                                                                   | <pre>map(object({<br> description = string<br> resource_group = string<br> scope = string<br> location = string<br> enabled = bool<br> severity = number<br> action_group = string<br> kql = string<br> criteria = object({<br> aggregation = string<br> aggregation_granularity = string<br> operator = string<br> threshold = number<br> measure_column = string # not usually needed for "count" aggregation<br> eval_frequency = string<br> })<br><br><br> }))</pre>                                                                     | `null`  |    no    |
| <a name="input_remote_state_hub_container"></a> [remote_state_hub_container](#input_remote_state_hub_container) | Storage Account container that contains Hub state file                                            | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_remote_state_hub_file"></a> [remote_state_hub_file](#input_remote_state_hub_file)                | State file name in Storage Account Container                                                      | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_remote_state_hub_rg_name"></a> [remote_state_hub_rg_name](#input_remote_state_hub_rg_name)       | Resource Group that contains core Hub state                                                       | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_remote_state_hub_sa_name"></a> [remote_state_hub_sa_name](#input_remote_state_hub_sa_name)       | Storage account that stores core Hub state                                                        | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_subscription_id"></a> [subscription_id](#input_subscription_id)                                  | Spoke/Workload Subscription ID                                                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_tenant_id"></a> [tenant_id](#input_tenant_id)                                                    | Tenant ID for this environment/subscription                                                       | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_vault_name"></a> [vault_name](#input_vault_name)                                                 | The name of the Recovery Services vault.                                                          | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_vault_resource_group_name"></a> [vault_resource_group_name](#input_vault_resource_group_name)    | The name of the resource group where the Recovery Services vault and backup policies are located. | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a     |   yes    |
| <a name="input_vms"></a> [vms](#input_vms)                                                                      | Information about the VMs to backup.                                                              | <pre>map(object({<br> resource_group = string<br> backup_policy = string<br> }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                       | n/a     |   yes    |

## Outputs

No outputs.

<!-- END_TF_DOCS -->
